<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Prescrições Dr. Pablo Xavier</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .medication-btn {
            display: inline-block;
            width: auto;
            padding: 5px 10px; /* Ajuste opcional do preenchimento */
            margin: 10px 0;
            background-color: #e49228;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #prescription-output {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            min-height: 100px;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 50%;
            border-radius: 8px;
        }
        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;

        }
        .action-buttons button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;

        }
        #copy-btn {
            background-color: #28a745;
            color: white;
        }
        #clear-btn {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h3>Prescrições Dr. Pablo Xavier</h3>
        
        <button class="medication-btn" onclick="openModal('Oxalato de Escitalopram')">
            Oxalato de Escitalopram
        </button>
        <button class="medication-btn" onclick="openModal('Cloridrato de Sertralina')">
            Cloridrato de Sertralina
        </button>
        <button class="medication-btn" onclick="openModal('Cloridrato de Bupropiona XL')">
            Cloridrato de Bupropiona XL
        </button>
        <button class="medication-btn" onclick="openModal('Cloridrato de Venlafaxina')">
            Cloridrato de Venlafaxina
        </button>

        <div id="prescription-output"></div>

        <div class="action-buttons">
            <button id="copy-btn" onclick="copyPrescription()">Copiar Prescrição</button>
            <button id="clear-btn" onclick="clearPrescription()">Limpar Prescrição</button>
        </div>
    </div>

    <!-- Modal para seleção de medicamentos -->
    <div id="medicationModal" class="modal">
        <div class="modal-content">
            <h2 id="modal-title"></h2>
            <form id="medication-form">
                <div>
                    <label>Forma de Uso:</label>
                    <select id="forma-uso" required>
                        <option value="USO ORAL">USO ORAL</option>
                        <option value="USO IM">USO IM</option>
                        <option value="USO INTRANASAL">USO INTRANASAL</option>
                        <option value="USO VIA RETAL">USO VIA RETAL</option>
                        <option value="USO VIA INALAÇÃO">USO VIA INALAÇÃO</option>
                    </select>
                </div>
                <div>
                    <label>Dose:</label>
                    <select id="dose" required></select>
                </div>
                <div>
                    <label>Quantidade:</label>
                    <input type="number" id="quantidade" required min="1">
                </div>
                <div>
                    <label>Instrução de Uso:</label>
                    <select id="instrucao" required></select>
                </div>
                <button type="submit">OK</button>
            </form>
        </div>
    </div>

    <script>
        const medications = {
            'Oxalato de Escitalopram': {
                doses: ['10mg', '15mg', '20mg'],
                brands: 'Reconter®, Fusor®, Esc® ou Eudok®',
                instructions: [
                    'Durante os 10 primeiros dias, tomar meio comprimido. A partir do 11º dia, iniciar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia Antes de dormir, no mesmo horário.'
                ],
                orientations: 'Durante as primeiras semanas de uso da medicação, é comum que você experimente alguns efeitos colaterais, como dor de cabeça, desconforto estomacal, tontura, tremores, insônia ou sonolência, náuseas, boca seca e diarreia. Além disso, pode haver um aumento temporário do nervosismo e da ansiedade. É importante lembrar que esses efeitos são geralmente transitórios e tendem a diminuir com o tempo. Por favor, não interrompa o uso do medicamento sem orientação médica, pois a continuidade do tratamento é fundamental para o seu progresso.'
            },
            'Cloridrato de Sertralina': {
                doses: ['25mg', '50mg', '100mg'],
                brands: 'Zoloft®, Assert®, Serenata®, Tolrest® ou Afetus®',
                instructions: [
                    'Durante os 10 primeiros dias, tomar meio comprimido. A partir do 11º dia, iniciar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia Antes de dormir, no mesmo horário.'
                ],
                orientations: 'Durante as primeiras semanas de uso da medicação, é comum que você experimente alguns efeitos colaterais, como dor de cabeça, desconforto estomacal, tontura, tremores, insônia ou sonolência, náuseas, boca seca e diarreia. Além disso, pode haver um aumento temporário do nervosismo e da ansiedade. É importante lembrar que esses efeitos são geralmente transitórios e tendem a diminuir com o tempo. Por favor, não interrompa o uso do medicamento sem orientação médica, pois a continuidade do tratamento é fundamental para o seu progresso.'
            },
            'Cloridrato de Bupropiona XL': {
                doses: ['150mg', '300mg'],
                brands: 'Alpes XL®, Bup XL®, Bupium XL®, Seth®, Zetron XL®',
                instructions: [
                    'Tomar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.'
                ]
            },
            'Cloridrato de Venlafaxina': {
                doses: ['37,5mg', '75mg', '150mg'],
                brands: 'Efexor®, Vinfa®, Venlex®',
                instructions: [
                    'Durante os 10 primeiros dias, tomar meio comprimido. A partir do 11º dia, iniciar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia. Sempre pela manhã, após se alimentar, no mesmo horário.',
                    'Tomar 1 comprimido por dia Antes de dormir, no mesmo horário.'
                ],
                orientations: 'Durante as primeiras semanas de uso da medicação, é comum que você experimente alguns efeitos colaterais, como dor de cabeça, desconforto estomacal, tontura, tremores, insônia ou sonolência, náuseas, boca seca e diarreia. Além disso, pode haver um aumento temporário do nervosismo e da ansiedade. É importante lembrar que esses efeitos são geralmente transitórios e tendem a diminuir com o tempo. Por favor, não interrompa o uso do medicamento sem orientação médica, pois a continuidade do tratamento é fundamental para o seu progresso.'
            }
        };

        let prescriptions = [];
        let prescriptionCounter = 1;

        function openModal(medication) {
            const modal = document.getElementById('medicationModal');
            const modalTitle = document.getElementById('modal-title');
            const doseSelect = document.getElementById('dose');
            const instructionSelect = document.getElementById('instrucao');

            modalTitle.textContent = medication;
            
            // Populate doses
            doseSelect.innerHTML = medications[medication].doses
                .map(dose => `<option value="${dose}">${dose}</option>`).join('');

            // Populate instructions
            instructionSelect.innerHTML = medications[medication].instructions
                .map((instruction, index) => 
                    `<option value="${index}">${instruction}</option>`
                ).join('');

            modal.style.display = 'block';
        }

        document.getElementById('medication-form').onsubmit = function(e) {
            e.preventDefault();
            const medication = document.getElementById('modal-title').textContent;
            const formaUso = document.getElementById('forma-uso').value;
            const dose = document.getElementById('dose').value;
            const quantidade = document.getElementById('quantidade').value;
            const instrucaoIndex = document.getElementById('instrucao').value;

            const newPrescription = {
                medication: medication,
                formaUso: formaUso,
                dose: dose,
                quantidade: quantidade,
                instrucao: medications[medication].instructions[instrucaoIndex],
                orientacoes: medications[medication].orientations,
                brands: medications[medication].brands
            };

            prescriptions.push(newPrescription);
            renderPrescription();
            document.getElementById('medicationModal').style.display = 'none';
            this.reset();
        };

        function renderPrescription() {
            const output = document.getElementById('prescription-output');
            const groupedPrescriptions = {};

            // Group by forma de uso
            prescriptions.forEach(p => {
                if (!groupedPrescriptions[p.formaUso]) {
                    groupedPrescriptions[p.formaUso] = [];
                }
                groupedPrescriptions[p.formaUso].push(p);
            });

            // Sort each group alphabetically
            Object.keys(groupedPrescriptions).forEach(key => {
                groupedPrescriptions[key].sort((a, b) => 
                    a.medication.localeCompare(b.medication)
                );
            });

            let prescriptionText = '';
            prescriptionCounter = 1;

            Object.keys(groupedPrescriptions).forEach((formaUso, groupIndex) => {
                prescriptionText += `${formaUso}\n`;
                groupedPrescriptions[formaUso].forEach((p, index, array) => {
                    prescriptionText += 
                        `${prescriptionCounter} - <strong>${p.medication}</strong> ${p.dose} ________ ${p.quantidade} cp\n` +
                        `(${p.brands})\n` +
                        `- ${p.instrucao}\n`;
                    
                    if (p.orientacoes) {
                        prescriptionText += `ORIENTAÇÕES:\n${p.orientacoes}\n`;
                    }
                    
                    // Adiciona uma linha em branco entre medicamentos, exceto no último
                    if (index < array.length - 1) {
                        prescriptionText += '\n';
                    }
                    
                    prescriptionCounter++;
                });

                // Adiciona duas linhas em branco entre grupos de medicamentos, 
                // exceto após o último grupo
                if (groupIndex < Object.keys(groupedPrescriptions).length - 1) {
                    prescriptionText += '\n\n';
                }
            });

            output.innerHTML = prescriptionText.replace(/\n/g, '<br>');
        }

        function copyPrescription() {
    const output = document.getElementById('prescription-output');
    const plainText = output.innerHTML
        .replace(/<br>/g, '\n') // Converte <br> em quebras de linha
        .replace(/<\/?strong>/g, '**'); // Substitui <strong> por marcação em negrito (**)

    // Cria um textarea temporário
    const tempTextArea = document.createElement('textarea');
    tempTextArea.value = plainText; // Define o valor como texto simples com marcações

    document.body.appendChild(tempTextArea); // Adiciona ao body
    tempTextArea.select(); // Seleciona o texto
    document.execCommand('copy'); // Copia o conteúdo

    document.body.removeChild(tempTextArea); // Remove o elemento temporário
    alert('Prescrição copiada com sucesso!');
}



        function clearPrescription() {
            const output = document.getElementById('prescription-output');
            output.innerHTML = '';
            prescriptions = [];
            prescriptionCounter = 1;
        }
    </script>
    <script>
        async function copyPrescription() {
            const output = document.getElementById('prescription-output');
        
            // Clonar o conteúdo e limpar estilos antes da cópia
            const clonedOutput = output.cloneNode(true);
            cleanStyles(clonedOutput);
        
            try {
                await navigator.clipboard.write([
                    new ClipboardItem({
                        "text/html": new Blob([clonedOutput.innerHTML], { type: "text/html" }),
                        "text/plain": new Blob([output.innerText], { type: "text/plain" })
                    })
                ]);
                console.log('Prescrição copiada com sucesso!');
            } catch (err) {
                console.error('Falha ao copiar: ', err);
                alert('Erro ao copiar a prescrição!');
            }
        }
        
        // Função para remover estilos inline
        function cleanStyles(element) {
            const elements = element.querySelectorAll("*");
            elements.forEach(el => el.removeAttribute("style"));
        }
        </script>
        
</body>
</html>
